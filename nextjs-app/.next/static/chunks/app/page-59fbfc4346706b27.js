(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{255:(e,t,n)=>{"use strict";function r(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return r}}),n(5155),n(7650),n(5744),n(589)},2146:(e,t,n)=>{"use strict";function r(e){let{reason:t,children:n}=e;return n}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return r}}),n(5262)},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{bindSnapshot:function(){return a},createAsyncLocalStorage:function(){return l},createSnapshot:function(){return u}});let n=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class r{disable(){throw n}getStore(){}run(){throw n}exit(){throw n}enterWith(){throw n}static bind(e){return e}}let o="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function l(){return o?new o:new r}function a(e){return o?o.bind(e):r.bind(e)}function u(){return o?o.snapshot():function(e,...t){return e(...t)}}},4912:(e,t,n)=>{Promise.resolve().then(n.bind(n,6570))},5744:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return r.workAsyncStorageInstance}});let r=n(7828)},6570:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var r=n(5155),o=n(2115),l=n(6645),a=n.n(l);let u=a()(()=>n.e(864).then(n.bind(n,7864)),{loadableGenerated:{webpack:()=>[7864]},ssr:!1}),s=a()(()=>n.e(76).then(n.bind(n,6076)),{loadableGenerated:{webpack:()=>[6076]},ssr:!1}),i=a()(()=>n.e(301).then(n.bind(n,5301)),{loadableGenerated:{webpack:()=>[5301]},ssr:!1}),c=a()(()=>n.e(221).then(n.bind(n,7221)),{loadableGenerated:{webpack:()=>[7221]},ssr:!1}),d="https://script.google.com/macros/s/AKfycbyir1J2OKNsoaOqaA8M8i3L13E398n6HNOChTWRb-RZd-LrkLwVNeg3zu1Kl8vnHakMfQ/exec";function f(){let[e,t]=(0,o.useState)(null),[n,l]=(0,o.useState)("orange"),[a,f]=(0,o.useState)(!1),[y,g]=(0,o.useState)(!1),[b,h]=(0,o.useState)(null),[p,_]=(0,o.useState)(null),[j,w]=(0,o.useState)("unknown"),[S,m]=(0,o.useState)(!0);(0,o.useEffect)(()=>{(async function(){try{let e=new Date,t=`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`,n=0===e.getDay(),r=["2025-01-01","2025-02-11","2025-03-21","2025-04-29","2025-05-03","2025-05-05","2025-07-15","2025-08-11","2025-09-16","2025-09-23","2025-10-14","2025-11-03","2025-11-23","2025-12-23"].includes(t)&&!n;g(n),f(r)}catch(e){console.error("祝日確認中にエラーが発生しました:",e),f(!1),g(!1)}})()},[]),(0,o.useEffect)(()=>{(async function(){m(!0);try{if(console.log("バススケジュールデータの取得を開始します"),!d)throw console.error("GAS_WEB_APP_URLが設定されていません"),Error("GAS_WEB_APP_URLが設定されていません");console.log(`GASスクリプトから直接データを取得します: ${d}`);let e=await fetch(d,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error(`HTTP Error: ${e.status}`);let n=await e.json();console.log("取得したデータ:",n);let r=P(n);t(r)}catch(e){console.error("データ取得に失敗しました:",e),console.log("フォールバックデータを使用します"),t(k())}finally{m(!1)}})()},[]);let P=e=>{console.log("データ処理を開始します:",e);try{let t=(t,n)=>e.Sheet1.filter(e=>e.route===t&&e.day_type===n).map(e=>e.time).sort(),n=t("orange","weekday"),r=t("orange","holiday"),o=t("green","weekday"),l=t("green","holiday"),a={orange:{weekday:n,holiday:r},green:{weekday:o,holiday:l}};return console.log("処理したバススケジュール:",a),a}catch(e){return console.error("データ処理中にエラーが発生しました:",e),k()}},k=()=>(console.log("フォールバックデータを使用します"),console.log("フォールバックデータを設定しました"),{orange:{weekday:["9:00","10:30","12:00","13:30","15:00","16:30"],holiday:["10:00","12:00","14:00","16:00"]},green:{weekday:["9:15","10:45","12:15","13:45","15:15","16:45"],holiday:["10:30","12:30","14:30","16:30"]}});(0,o.useEffect)(()=>{function t(){let t;if(!e)return;let r=new Date,o=60*r.getHours()+r.getMinutes();if(y)t=e[n].holiday;else if(a){w("not-running"),h(null),_(null);return}else t=e[n].weekday;if(!t||0===t.length){w("not-running"),h(null),_(null);return}let l=null,u=1/0;for(let e of t){let[t,n]=e.split(":").map(Number),r=60*t+n-o;r>0&&r<u&&(u=r,l=e)}if(!l){w("day-ended"),h(null),_(null);return}h(l),_(u),w("running")}t();let r=setInterval(t,6e4);return()=>clearInterval(r)},[e,n,a,y]);let v=async()=>{try{if(!d)throw Error("GAS_WEB_APP_URLが設定されていません");m(!0);let e=await fetch(d,{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!e.ok)throw Error(`HTTP Error: ${e.status}`);let n=await e.json(),r=P(n);t(r)}catch(e){console.error("データの再取得に失敗しました:",e)}finally{m(!1)}};return S&&!e?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"データを読み込み中..."}):(0,r.jsxs)("div",{children:[(0,r.jsx)(u,{}),(0,r.jsx)(c,{currentRoute:n,setRoute:e=>{l(e)}}),(0,r.jsx)(i,{operatingStatus:j,nextBusDeparture:b,minutesToNextBus:p,onUpdate:v}),(0,r.jsx)(s,{busSchedule:e,currentRoute:n,isHoliday:a,isSunday:y,nextBusDeparture:b,minutesToNextBus:p})]})}},6645:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let r=n(8229)._(n(7357));function o(e,t){var n;let o={};"function"==typeof e&&(o.loader=e);let l={...o,...t};return(0,r.default)({...l,modules:null==(n=l.loadableGenerated)?void 0:n.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7357:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let r=n(5155),o=n(2115),l=n(2146);function a(e){return{default:e&&"default"in e?e.default:e}}n(255);let u={loader:()=>Promise.resolve(a(()=>null)),loading:null,ssr:!0},s=function(e){let t={...u,...e},n=(0,o.lazy)(()=>t.loader().then(a)),s=t.loading;function i(e){let a=s?(0,r.jsx)(s,{isLoading:!0,pastDelay:!0,error:null}):null,u=!t.ssr||!!t.loading,i=u?o.Suspense:o.Fragment,c=t.ssr?(0,r.jsxs)(r.Fragment,{children:[null,(0,r.jsx)(n,{...e})]}):(0,r.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(n,{...e})});return(0,r.jsx)(i,{...u?{fallback:a}:{},children:c})}return i.displayName="LoadableComponent",i}},7828:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return r}});let r=(0,n(4054).createAsyncLocalStorage)()}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(4912)),_N_E=e.O()}]);